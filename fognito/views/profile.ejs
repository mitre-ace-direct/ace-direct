<!doctype html>
<html>

<head>
  <title>Profile</title>
  <%- include('partials/includes') %>
</head>

<body>
  <div class="content-wrapper">
    <!-- Main content -->
    <section class="content">
      <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
          <h3>Welcome, <span id="welcomeName">
              <%=user.firstname%>&nbsp;<%=user.lastname%><small>&nbsp;(<a href="/logout">log out</a>)</small>
            </span></h3>
        </div>
      </div>
      <div class="container">
        <div class="row">
          <div class="col-12">
            <form id="editUserForm" method="post" action="./updateProfile">
              <div class="form-group">
                <div class="col-sm-12">
                  <label for="firstname" class="control-label">First Name</label>

                  <input type="text" class="form-control" id="firstname" name="firstname" placeholder="First name"
                    required value='<%=user.firstname%>'>
                </div>
              </div>
              <div class="form-group">
                <div class="col-sm-12">
                  <label for="lastname" class="control-label">Last Name</label>

                  <input type="text" class="form-control" id="lastname" name="lastname" required
                    value='<%=user.lastname%>'>
                </div>
              </div>
              <div class="form-group">
                <div class="col-sm-12">
                  <label for="role" class="control-label">Role</label>

                  <input type="text" class="form-control" id="role" name="role" placeholder="Role"
                    value='<%=user.role%>' disabled>
                </div>
              </div>
              <div class="form-group">
                <div class="col-sm-12">
                  <label for="email" class="control-label">Email</label>
                  <input type="email" class="form-control" id="email" name="email" placeholder="Email Address"
                    value='<%=user.email%>' disabled>
                </div>
              </div>
              <div class="form-group">
                <div class="col-sm-12">
                  <label for="phone" class="control-label">Phone</label>
                  <input type="tel" class="form-control" id="phone" name="phone" placeholder="Phone"
                    value='<%=user.phone%>' disabled>
                </div>
              </div>
              <div class="form-group">
                <div class="col-sm-12">
                  <button type="submit" class="btn btn-sm btn-success" id="edit_user_info_btn">Update Info</button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </section>
  </div>
  <script>
    $(document).ready(function () {
      var $form = $('form');
      $form.submit(function (evt) {
        evt.preventDefault();
        $.post($(this).attr('action'), $(this).serialize())
          .done(function () {
            location.reload()
          })
          .fail(function (jqXHR, textStatus, errorThrown) {
            alert("Error: " + jqXHR.responseText);
          });
      });
    });
  </script>
</body>

</html>